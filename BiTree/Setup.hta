<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta content="text/html; charset=utf-8" http-equiv="Content-Type" /><title>EasyX 20200902 安装向导</title><script type="text/javascript">var w=503,h=365;window.resizeTo(w,h);window.moveTo((window.screen.width-w)>>1,(window.screen.height-h)>>1);</script><HTA:APPLICATION ID="oHTA" APPLICATIONNAME="EasyX 安装向导" BORDER="dialog" CONTEXTMENU="no" INNERBORDER="no" MAXIMIZEBUTTON="no" MINIMIZEBUTTON="yes" SCROLL="no" SELECTION="no" SINGLEINSTANCE="yes" VERSION="20200902" /><style type="text/css">html,body{height:100%;width:100%;margin:0px;font-size:12px}body{position:relative;overflow:hidden;background-color:#ECE9D8}td{font-size:12px}.main{height:10%;padding:10px 16px}#welcome .main{padding:0px}#wel_l{float:left; width:136px; height:504px; color:#ACA899; background-color:#000080; font-size:48px; writing-mode:tb-rl; font-family:Arial; padding:14px}#wel_r{padding:14px 16px; height:500px; background-color:#fff}#wel_b{width:100%; height:42px; line-height:41px; position:absolute; bottom:0px; left:0px; background-color:#ECE9D8; border-top:1px solid #ACA899}#wel_b #wel_b2{border-top:1px solid #FFF; text-align:right}.head{width:100%; background-color:white; border-bottom:1px solid #FFF}.head .head2{height:33px; padding:10px 16px; border-bottom:1px solid #ACA899}.foot{width:100%; height:41px; line-height:41px; position:absolute; bottom:0px; left:0px; text-align:right}#itemlist td{vertical-align:middle;border-bottom:1px solid #888888}input{height:29px; font-size:12px}#btnPrev,#btnNext,#btnClose{width:72px}#btnClose{margin:0px 14px}.path{display:block; width:230px; overflow:hidden; white-space:nowrap; text-overflow:ellipsis}</style></head><script type="text/javascript">String.prototype.Trim=function(){return this.replace(/(^\s+)|(\s+$)/g,"")};		 String.prototype.StartsWith=function(prefix){return this.slice(0, prefix.length)===prefix;};		 String.prototype.EndsWith=function(suffix){return this.indexOf(suffix, this.length - suffix.length)!==-1;};		 function $(objID){return document.getElementById(objID);}var HKCR = 0x80000000;	 var HKCU = 0x80000001;	 var HKLM = 0x80000002;	 var HKEY_USERS = 0x80000003;	 var HKEY_PERFORMANCE_DATA = 0x80000004;var HKEY_CURRENT_CONFIG = 0x80000005;var HKEY_DYN_DATA = 0x80000006;function RegEnumKeys(regpath){var defkey = regpath.match(/^[^\\]*/)[0];var subkeyname = regpath.substr(defkey.length + 1);switch(defkey){case "HKEY_CURRENT_USER": case "HKCU":				defkey = HKCU;					break;case "HKEY_LOCAL_MACHINE": case "HKLM":				defkey = HKLM;					break;case "HKEY_CLASSES_ROOT": case "HKCR":				defkey = HKCR;					break;case "HKEY_USERS":			defkey = HKEY_USERS;			break;case "HKEY_PERFORMANCE_DATA":defkey = HKEY_PERFORMANCE_DATA;	break;case "HKEY_CURRENT_CONFIG":	defkey = HKEY_CURRENT_CONFIG;	break;case "HKEY_DYN_DATA":		defkey = HKEY_DYN_DATA;			break;}var aNames = null;var oReg = GetObject("winmgmts:root\\default:StdRegProv");var oMethod = oReg.Methods_.Item("EnumKey");var oInParam = oMethod.InParameters.SpawnInstance_();oInParam.hDefKey = defkey;oInParam.sSubKeyName = subkeyname;var oOutParam = oReg.ExecMethod_(oMethod.Name, oInParam);switch(oOutParam.ReturnValue){case 0:		 aNames = (oOutParam.sNames != null) ? oOutParam.sNames.toArray():null;break;case 2:		 aNames = null;break;}return aNames;}function RegRead(regpath){var defkey = regpath.match(/^[^\\]*/)[0];var subkeyname = regpath.substr(defkey.length + 1);if (defkey == "HKCU" || defkey == "HKEY_CURRENT_USER"){var aNames = RegEnumKeys("HKEY_USERS\\");if (aNames != null){for (var i = aNames.length - 1; i >= 0; i--){var len = aNames[i].length;if (len < 2 ) continue;if (aNames[i].substr(0, 2) != "S-") continue;if (aNames[i].substr(len - 8) == "_Classes") continue;var rtn = RegRead("HKEY_USERS\\" + aNames[i] + "\\" + subkeyname);if (rtn != "") return rtn;}}return "";}var shell = new ActiveXObject("WScript.Shell");var s="";try{s=shell.RegRead(regpath);}catch(e){}return s;}var $fso=new ActiveXObject("Scripting.FileSystemObject");var $wsh = new ActiveXObject("WScript.Shell");function DeleteFile(dst){if($fso.FileExists(dst)){try{$fso.DeleteFile(dst, true);if ($fso.FileExists(dst)) throw new Error("可能是因为权限不够，或者被杀毒软件拦截。");}catch(e){return "“"+dst+"”删除失败，原因："+e.description+"\r\n";}}return "";}function CopyFile(src, dst){DeleteFile(dst);try{$fso.CopyFile(src, dst, true);if (!$fso.FileExists(dst)) throw new Error("可能是因为权限不够，或者被杀毒软件拦截。");}catch(e){return "“"+dst+"”复制失败，原因："+e.description+"\r\n";}return "";}</script><script type="text/javascript">var g_bX64 = RegRead("HKLM\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Environment\\PROCESSOR_ARCHITECTURE") == "AMD64";var g_pathDesktop = (new ActiveXObject("WScript.Shell")).SpecialFolders("Desktop");if (g_pathDesktop.charAt(g_pathDesktop.length - 1) != '\\') g_pathDesktop += '\\';</script><script type="text/javascript">function GetVCPath(iVsVer){var path = null;switch(iVsVer){case 6: path = "HKCU\\Software\\Microsoft\\DevStudio\\6.0\\Build System\\Components\\Platforms\\Win32 (x86)\\Directories\\Library Dirs";break;case 2008:path = "HKLM\\Software\\" + (g_bX64 ? "WOW6432Node\\" :"") + "Microsoft\\VisualStudio\\SxS\\VC7\\9.0"; break;case 2010:path = "HKLM\\Software\\" + (g_bX64 ? "WOW6432Node\\" :"") + "Microsoft\\VisualStudio\\SxS\\VC7\\10.0"; break;case 2012:path = "HKLM\\Software\\" + (g_bX64 ? "WOW6432Node\\" :"") + "Microsoft\\VisualStudio\\SxS\\VC7\\11.0"; break;case 2013:path = "HKLM\\Software\\" + (g_bX64 ? "WOW6432Node\\" :"") + "Microsoft\\VisualStudio\\SxS\\VC7\\12.0"; break;case 2015:path = "HKLM\\Software\\" + (g_bX64 ? "WOW6432Node\\" :"") + "Microsoft\\VisualStudio\\SxS\\VC7\\14.0"; break;case 2017: path = "HKLM\\Software\\" + (g_bX64 ? "WOW6432Node\\" :"") + "Microsoft\\Windows\\CurrentVersion\\Uninstall";keys = RegEnumKeys(path);for (var i = keys.length - 1; i >= 0; i--){var rtn = RegRead(path + "\\" + keys[i] + "\\DisplayName");if (rtn != ""){if (/^Visual Studio (Community|Professional|Enterprise) 2017( \([^\)]+\))?$/.test(rtn)){path = path + "\\" + keys[i] + "\\InstallLocation";break;}}}break;case 2019: path = "HKLM\\Software\\" + (g_bX64 ? "WOW6432Node\\" :"") + "Microsoft\\Windows\\CurrentVersion\\Uninstall";keys = RegEnumKeys(path);for (var i = keys.length - 1; i >= 0; i--){var rtn = RegRead(path + "\\" + keys[i] + "\\DisplayName");if (rtn != ""){if (/^Visual Studio (Community|Professional|Enterprise) 2019( \([^\)]+\))?$/.test(rtn)){path = path + "\\" + keys[i] + "\\InstallLocation";break;}}}break;}path = RegRead(path);switch(iVsVer){case 6: if (path != null){var arys=path.match( /[^;]+\\(?=vc98\\mfc\\lib$|vc98\\mfc\\lib;)/i );if ((arys != null) && (arys.length != 0)){path = arys[0];if (path.length == 0) path = null; else path += "VC98\\";}}break;case 2017: case 2019: if (path != null && path.charAt(path.length - 1) != '\\') path += '\\';path += "VC\\Auxiliary\\VS\\";break;default: break;}if (path != null && !$fso.FolderExists(path)) path = null;if (path != null && path.charAt(path.length - 1) != '\\') path += '\\';return path;}function GetIncludePath(iVcVer){if (iVcVer == 6) return "Include\\";else return "include\\";}function GetLibX86Path(iVcVer){switch(iVcVer){case 6:	return "Lib\\";	break;case 2008: case 2010: case 2012: case 2013: case 2015:return "lib\\";			break;case 2017:return "lib\\x86\\";	break;case 2019:return "lib\\x86\\";	break;}}function GetLibX64Path(iVcVer){switch(iVcVer){case 6:	return null;	break;case 2008: case 2010: case 2012: case 2013: case 2015:return "lib\\amd64\\";	break;case 2017:return "lib\\x64\\";	break;case 2019:return "lib\\x64\\";	break;}}var files=[{"path":"include\\","name":"easyx.h"},{"path":"include\\","name":"graphics.h"},{"path":"lib\\VC6\\x86\\","name":"EasyXa.lib"},{"path":"lib\\VC6\\x86\\","name":"EasyXw.lib"},{"path":"lib\\VC2008\\x86\\","name":"EasyXa.lib"},{"path":"lib\\VC2008\\x86\\","name":"EasyXw.lib"},{"path":"lib\\VC2008\\x64\\","name":"EasyXa.lib"},{"path":"lib\\VC2008\\x64\\","name":"EasyXw.lib"},{"path":"lib\\VC2015\\x86\\","name":"EasyXa.lib"},{"path":"lib\\VC2015\\x86\\","name":"EasyXw.lib"},{"path":"lib\\VC2015\\x64\\","name":"EasyXa.lib"},{"path":"lib\\VC2015\\x64\\","name":"EasyXw.lib"}];var groups=[{"name":"Visual C++ 6.0",	"ver":6,	"vcpath":null, "path_h":null, "path_libx86":null, "path_libx64":null, "files_h":[0,1], "files_libx86":[2,3], "files_libx64":[]},{"name":"Visual C++ 2008",	"ver":2008,	"vcpath":null, "path_h":null, "path_libx86":null, "path_libx64":null, "files_h":[0,1], "files_libx86":[4,5], "files_libx64":[6,7]},{"name":"Visual C++ 2010",	"ver":2010,	"vcpath":null, "path_h":null, "path_libx86":null, "path_libx64":null, "files_h":[0,1], "files_libx86":[4,5], "files_libx64":[6,7]},{"name":"Visual C++ 2012",	"ver":2012,	"vcpath":null, "path_h":null, "path_libx86":null, "path_libx64":null, "files_h":[0,1], "files_libx86":[4,5], "files_libx64":[6,7]},{"name":"Visual C++ 2013",	"ver":2013,	"vcpath":null, "path_h":null, "path_libx86":null, "path_libx64":null, "files_h":[0,1], "files_libx86":[4,5], "files_libx64":[6,7]},{"name":"Visual C++ 2015",	"ver":2015,	"vcpath":null, "path_h":null, "path_libx86":null, "path_libx64":null, "files_h":[0,1], "files_libx86":[8,9], "files_libx64":[10,11]},{"name":"Visual C++ 2017",	"ver":2017,	"vcpath":null, "path_h":null, "path_libx86":null, "path_libx64":null, "files_h":[0,1], "files_libx86":[8,9], "files_libx64":[10,11]},{"name":"Visual C++ 2019",	"ver":2019,	"vcpath":null, "path_h":null, "path_libx86":null, "path_libx64":null, "files_h":[0,1], "files_libx86":[8,9], "files_libx64":[10,11]}];</script><body><div id="welcome"><div class="main"><div id="wel_l">EasyX</div><div id="wel_r"><h1 style="font-size:16px">欢迎使用“EasyX 20200902”安装向导</h1>EasyX 库为 C/C++ 提供了简单的绘图接口，可以帮助您快速编写图形程序。<br /><br />这个向导将帮助您安装 EasyX 库到指定开发环境中。EasyX 目前支持 Visual C++ 6 / 2008 ~ 2019。<br /><br />如果您希望手动安装 EasyX，请参见帮助文件。<br /><br />单击 [下一步] 继续。</div></div><div id="wel_b"><div id="wel_b2"><input id="btnNext" onclick="step_setup()" type="button" value="下一步 &gt;" disabled="disabled" />&nbsp;<input id="btnClose" onclick="window.close()" type="button" value="取消" /></div></div></div><div id="setup" style="display:none"><div class="head"><div class="head2"><b>执行安装</b><br /><span>　　请针对您所用的开发平台，选择安装或卸载。</span></div></div><div class="foot"><input id="btnPrev" onclick="step_welcome()" type="button" value="&lt; 上一步" />&nbsp;<input id="btnClose" onclick="window.close()" type="button" value="关闭" /><div style="overflow:hidden;margin:8px;height:0px;width:96.8%; border-top:1px solid #ACA899; border-bottom:1px solid #FFFFFF;position:absolute;top:-10px;left:0px;"></div><label disabled="disabled" style="line-height:14px;padding:0px 4px;background-color:#ECE9D8;position:absolute;top:-9px;left:8px;">EasyX Install System v5.0</label></div><div class="main">在下表中找到您所用的的开发平台，点击右侧的“安装”将 EasyX 库安装至该开发平台。或点击右侧的“卸载”将 EasyX 库从该开发平台移除。<div style="height:160px;width:100%;overflow-x:hidden;overflow-y:scroll;margin:10px;"><table style="width:440px" style="height:auto" id="itemlist"><tbody id="helplist"></tbody><tbody id="idelist"></tbody><tbody id="ideignored"></tbody></table></div></div></div><script type="text/javascript">function step_welcome(){$("welcome").style.display="block";$("setup").style.display="none";}function step_setup(){$("welcome").style.display="none";$("setup").style.display="block";InitHelpList();InitIDEList();}function UninstallOldEasyX(id){if(groups[id].ver==2017 || groups[id].ver==2019){var oldpath = groups[id].vcpath;if (oldpath.EndsWith("\\Auxiliary\\VS\\")){oldpath = oldpath.substr(0, oldpath.length-13);var verfile = oldpath + "Auxiliary\\Build\\Microsoft.VCToolsVersion.default.txt";if($fso.FileExists(verfile)){oldpath += "Tools\\MSVC\\" + ($fso.opentextfile(verfile, 1, false)).Readline().Trim() + "\\";var f;for(i=0; i<groups[id].files_h.length; i++){f=oldpath + groups[id].path_h + files[groups[id].files_h[i]].name;DeleteFile(f);}for(i=0; i<groups[id].files_libx86.length; i++){f=oldpath + groups[id].path_libx86 + files[groups[id].files_libx86[i]].name;DeleteFile(f);}for(i=0; i<groups[id].files_libx64.length; i++){f=oldpath + groups[id].path_libx64 + files[groups[id].files_libx64[i]].name;DeleteFile(f);}}}}}function Install(id){if(groups[id].ver==2017 || groups[id].ver==2019){UninstallOldEasyX(id);}var err="";for(i=0; i<groups[id].files_h.length; i++){var src=files[groups[id].files_h[i]].path + files[groups[id].files_h[i]].name;var dst=groups[id].vcpath + groups[id].path_h + files[groups[id].files_h[i]].name;err+=CopyFile(src, dst);}for(i=0; i<groups[id].files_libx86.length; i++){var src=files[groups[id].files_libx86[i]].path + files[groups[id].files_libx86[i]].name;var dst=groups[id].vcpath + groups[id].path_libx86 + files[groups[id].files_libx86[i]].name;err+=CopyFile(src, dst);}if (groups[id].path_libx64 != null){for(i=0; i<groups[id].files_libx64.length; i++){var src=files[groups[id].files_libx64[i]].path + files[groups[id].files_libx64[i]].name;var dst=groups[id].vcpath + groups[id].path_libx64 + files[groups[id].files_libx64[i]].name;err+=CopyFile(src, dst);}}if(err.length>0) alert("安装失败。\n\n以下文件在安装时遇到问题：\n"+err);else alert("安装成功。");}function Uninstall(id){if(groups[id].ver==2017 || groups[id].ver==2019){UninstallOldEasyX(id);}var err="";var f;for(i=0; i<groups[id].files_h.length; i++){f=groups[id].vcpath + groups[id].path_h + files[groups[id].files_h[i]].name;err+=DeleteFile(f);}for(i=0; i<groups[id].files_libx86.length; i++){f=groups[id].vcpath + groups[id].path_libx86 + files[groups[id].files_libx86[i]].name;err+=DeleteFile(f);}for(i=0; i<groups[id].files_libx64.length; i++){f=groups[id].vcpath + groups[id].path_libx64 + files[groups[id].files_libx64[i]].name;err+=DeleteFile(f);}if(err.length>0) alert("卸载失败。\n\n以下文件在删除时遇到问题：\n"+err);else alert("卸载成功。");}function InstallHelp(){var oUrlLink = $wsh.CreateShortcut(g_pathDesktop + "EasyX_Help.url");oUrlLink.TargetPath = "https://docs.easyx.cn";oUrlLink.Save();alert("安装成功。");}function UninstallHelp(){var err="";err+=DeleteFile(g_pathDesktop + "EasyX_Help.url");if(err.length>0) alert("卸载失败。\n\n以下文件在删除时遇到问题：\n"+err);else alert("卸载成功。");}function InitHelpList(){var tb = document.getElementById("helplist");while(tb.hasChildNodes()) tb.removeChild(tb.lastChild);tr=document.createElement("tr");td=document.createElement("td");td.innerHTML="EasyX 文档";td.noWrap=true;tr.appendChild(td);td=document.createElement("td");td.innerHTML="<span class=\"path\">在线文档 https://docs.easyx.cn</span><span class=\"path\" title=\""+g_pathDesktop+"\">桌面路径 "+g_pathDesktop+"</span>";tr.appendChild(td);td=document.createElement("td");td.innerHTML="<input onclick='InstallHelp()' type='button' value='安装' /> <input onclick='UninstallHelp()' type='button' value='卸载' />";td.noWrap=true;tr.appendChild(td);$("helplist").appendChild(tr);}function InitIDEList(){var tb = document.getElementById("idelist");while(tb.hasChildNodes()) tb.removeChild(tb.lastChild);tb = document.getElementById("ideignored");while(tb.hasChildNodes()) tb.removeChild(tb.lastChild);for(var i in groups){var v = groups[i].ver;groups[i].vcpath = GetVCPath(v);groups[i].path_h = GetIncludePath(v);if (!$fso.FolderExists(groups[i].vcpath + groups[i].path_h)){groups[i].vcpath = null;groups[i].path_h = null;continue;}groups[i].path_libx86 = GetLibX86Path(v);if (!$fso.FolderExists(groups[i].vcpath + groups[i].path_libx86)){groups[i].vcpath = null;groups[i].path_h = null;groups[i].path_libx86 = null;continue;}groups[i].path_libx64 = GetLibX64Path(v);if (!$fso.FolderExists(groups[i].vcpath + groups[i].path_libx64)){groups[i].path_libx64 = null;}}for (i=0; i<groups.length; i++){tr=document.createElement("tr");	tr.id="ide"+i;td=document.createElement("td");	td.id="ide"+i+"_Name";td.innerHTML=groups[i].name;td.noWrap=true;tr.appendChild(td);td=document.createElement("td");	td.id="ide"+i+"_Cfg";if(groups[i].vcpath != null){var libpath = groups[i].vcpath+groups[i].path_libx86;if (groups[i].path_libx64 != null) libpath += ";\r\n" + groups[i].vcpath+groups[i].path_libx64;td.innerHTML="<span class=\"path\" title=\""+groups[i].vcpath+groups[i].path_h+"\">头文件路径 "+groups[i].vcpath+groups[i].path_h+"</span><span class=\"path\" title=\""+libpath+"\">库文件路径 "+libpath+"</span>";}else td.innerHTML="<span class=\"path\">(未检测到)</span>";tr.appendChild(td);td=document.createElement("td");	td.id="ide"+i+"_Opt";if(groups[i].vcpath != null) td.innerHTML="<input onclick='Install("+i+")' type='button' value='安装' /> <input onclick='Uninstall("+i+")' type='button' value='卸载' />";else td.innerHTML="<input disabled='disabled' type='button' value='安装' /> <input disabled='disabled' type='button' value='卸载' />";td.noWrap=true;tr.appendChild(td);if(groups[i].vcpath != null) $("idelist").appendChild(tr);else $("ideignored").appendChild(tr);}}function CheckSrc(){var root=unescape(location.pathname);root=root.substring(0, root.lastIndexOf("\\") + 1);	 for(f in files) files[f].path=root+files[f].path;for(f in files) if(!$fso.FileExists(files[f].path+files[f].name)) return false;return true;}if (CheckSrc()) $("btnNext").disabled="";else{alert("遇到错误：安装程序不完整。\n\n请检查：\n\n1. 是否有杀毒软件误判？\n　 一些粗暴的杀毒软件会将所有的 hta 脚本视为病毒。如果您安装了类似杀毒软件，请临时将其关闭，待安装完毕后再重新打开该杀毒软件。\n\n2. 您是否从官方网站下载的安装包？\n　 请到官方网站(https://easyx.cn)下载最新的安装包。\n\n如果排除以上几点问题后仍不能正常安装，请到官方网站反馈给我们，谢谢！");window.close();exit(0);}</script></body></html>